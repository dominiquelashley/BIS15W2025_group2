`artist(s)_name` == "Eminem")
playlist_type_most_streamed
playlist_type_most_streamed <- playlist_type_most_streamed %>%
pivot_longer(-`artist(s)_name`,
names_to = "playlist_type",
values_to = "n_playlists")
playlist_type_most_streamed %>%
ggplot(aes(x=`artist(s)_name`, y=n_playlists))+
geom_boxplot()+
scale_y_log10()+
facet_grid(.~playlist_type)
theme(axis.text.x = element_text(angle = 60, hjust=1)
playlist_type_most_streamed %>%
#scale_y_log10()+
facet_grid(.~playlist_type)
playlist_type_most_streamed %>%
ggplot(aes(x=`artist(s)_name`, y=n_playlists))+
geom_boxplot()+
#scale_y_log10()+
facet_grid(.~playlist_type)
playlist_type_most_streamed %>%
ggplot(aes(x=`artist(s)_name`, y=n_playlists))+
geom_boxplot()+
scale_y_log10()+
facet_grid(.~playlist_type)
playlist_type_most_streamed %>%
ggplot(aes(x=`artist(s)_name`, y=n_playlists))+
geom_boxplot()+
scale_y_log10()+
facet_grid(.~playlist_type)+
coord_flip()
playlist_type_most_streamed %>%
ggplot(aes(x=`artist(s)_name`, y=n_playlists))+
geom_boxplot()+
scale_y_log10()+
facet_grid(playlist_type~.)+
coord_flip()
playlist_type_most_streamed %>%
ggplot(aes(x=`playlist_type`, y=n_playlists))+
geom_boxplot()+
scale_y_log10()+
facet_grid(`artist(s)_name`~.)+
coord_flip()
playlist_type_most_streamed %>%
ggplot(aes(x=`playlist_type`, y=n_playlists))+
geom_boxplot()+
scale_y_log10()+
facet_grid(.~`artist(s)_name`)+
coord_flip()
knitr::opts_chunk$set(echo = TRUE)
most_streamed<-read_csv("~/Desktop/BIS15W2025_group2/Spotify Most Streamed Songs.csv")
library(tidyverse)
library(janitor)
library(naniar)
options(scipen = 999)
knitr::opts_chunk$set(echo = TRUE)
most_streamed<-read_csv("~/Desktop/BIS15W2025_group2/Spotify Most Streamed Songs.csv")
most_streamed %>%
clean_names()
names()
most_streamed %>%
ggplot(aes(x=reorder(key, in_spotify_charts), y=in_spotify_charts))+
geom_col()+
coord_flip()
most_streamed %>%
ggplot(aes(x=`danceability_%`))+
geom_density(fill="violetred", alpha=0.5)
most_streamed %>%
ggplot(aes(x=`danceability_%`))+
geom_density(fill="violetred", alpha=0.5)
most_streamed %>%
ggplot(aes(x=in_spotify_playlists))+
geom_density(fill="violetred", alpha=0.5)
most_streamed %>%
group_by(`artist(s)_name`) %>%
summarize(total_playlists=sum(in_spotify_playlists, in_apple_playlists, in_deezer_playlists)) %>%
arrange(-`total_playlists`)
top_five_artists_playlists<-
most_streamed %>%
filter(`artist(s)_name` == "The Weeknd" |
`artist(s)_name` =="Ed Sheeran"|
`artist(s)_name` == "Taylor Swift" |
`artist(s)_name` =="Harry Styles" |
`artist(s)_name` == "Eminem")
top_five_artists_playlists %>%
count(`artist(s)_name`)
most_streamed %>%
group_by(`artist(s)_name`) %>%
summarize(total_charts=sum(in_spotify_charts, in_apple_charts, in_deezer_charts, in_shazam_charts)) %>%
arrange(-`total_charts`)
top_five_artists_charts<-
most_streamed %>%
filter(`artist(s)_name` == "Taylor Swift" |
`artist(s)_name` =="Bad Bunny"|
`artist(s)_name` == "Jain" |
`artist(s)_name` =="SZA" |
`artist(s)_name` == "Miley Cyrus")
most_streamed %>%
group_by(`danceability_%`) %>%
summarize(total_charts=sum(in_spotify_charts, in_apple_charts, in_deezer_charts, in_shazam_charts)) %>%
ggplot(aes(x=`danceability_%`, y=total_charts))+
geom_jitter()
most_streamed %>%
group_by(`danceability_%`) %>%
summarize(total_charts=sum(in_spotify_charts, in_apple_charts, in_deezer_charts, in_shazam_charts, na.rm=T),
total_playlists=sum(in_spotify_playlists, in_apple_playlists, in_deezer_playlists, na.rm=T)) %>%
ggplot(aes(x=`danceability_%`, y=total_charts))+
geom_jitter()
most_streamed %>%
group_by(`danceability_%`) %>%
summarize(total_charts=sum(in_spotify_charts, in_apple_charts, in_deezer_charts, in_shazam_charts, na.rm=T),
total_playlists=sum(in_spotify_playlists, in_apple_playlists, in_deezer_playlists, na.rm=T)) %>%
ggplot(aes(x=`danceability_%`, y=total_playlists))+
geom_jitter()
most_streamed %>%
group_by(`key`) %>%
summarize(total_charts=sum(in_spotify_charts, in_apple_charts, in_deezer_charts, in_shazam_charts, na.rm=T),
total_playlists=sum(in_spotify_playlists, in_apple_playlists, in_deezer_playlists, na.rm=T)) %>%
ggplot(aes(x=`key`, y=total_charts))+
geom_col()
most_streamed %>%
group_by(`key`) %>%
summarize(total_charts=sum(in_spotify_charts, in_apple_charts, in_deezer_charts, in_shazam_charts, na.rm=T),
total_playlists=sum(in_spotify_playlists, in_apple_playlists, in_deezer_playlists, na.rm=T)) %>%
ggplot(aes(x=`key`, y=total_playlists))+
geom_col()
most_streamed %>%
group_by(`energy_%`) %>%
summarize(total_charts=sum(in_spotify_charts, in_apple_charts, in_deezer_charts, in_shazam_charts)) %>%
ggplot(aes(x=`energy_%`, y=total_charts))+
geom_jitter()
most_streamed %>%
group_by(`energy_%`) %>%
summarize(total_charts=sum(in_spotify_charts, in_apple_charts, in_deezer_charts, in_shazam_charts)) %>%
ggplot(aes(x=`energy_%`, y=total_charts))+
geom_jitter()
playlist_type_most_streamed <- playlist_type_most_streamed %>%
pivot_longer(-`artist(s)_name`,
names_to = "playlist_type",
values_to = "n_playlists")
playlist_type_most_streamed<-
most_streamed %>%
select(in_spotify_playlists, in_apple_playlists, in_deezer_playlists, `artist(s)_name`) %>%
filter(`artist(s)_name` == "The Weeknd" |
`artist(s)_name` =="Ed Sheeran"|
`artist(s)_name` == "Taylor Swift" |
`artist(s)_name` =="Harry Styles" |
`artist(s)_name` == "Eminem")
playlist_type_most_streamed
playlist_type_most_streamed <- playlist_type_most_streamed %>%
pivot_longer(-`artist(s)_name`,
names_to = "playlist_type",
values_to = "n_playlists")
playlist_type_most_streamed %>%
ggplot(aes(x=`playlist_type`, y=n_playlists))+
geom_boxplot()+
scale_y_log10()+
facet_grid(.~`artist(s)_name`)+
coord_flip()
View(most_streamed)
names()
most_streamed %>%
names()
glimpse(most_streamed)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(shiny)
library(shinydashboard)
require(janitor)
library(ggplot2)
library(bslib)
# load the data
spotify_data <- read_csv("~/Desktop/BIS15W2025_group2/Spotify Most Streamed Songs.csv") %>% clean_names()
# Filtered data frame from the app
artist_app_data <- spotify_data %>%
mutate(streams=as.numeric(streams, na.rm=T)) %>%
group_by(artist_s_name) %>%
summarize(total_streams=sum(streams, na.rm=T),
total_charts=sum(in_spotify_charts, na.rm=T),
total_playlists=sum(in_spotify_playlists, na.rm=T))
# Filtered data frame from the app
song_app_data <-
spotify_data %>%
mutate(streams=as.numeric(streams, na.rm=T)) %>%
group_by(track_name) %>%
summarize(total_streams=sum(streams, na.rm = T),
total_charts=sum(in_spotify_charts, na.rm = T),
total_playlists=sum(in_spotify_playlists, na.rm = T))
# using pivot longer to have a list of the attributes
spotify_data_long <- spotify_data %>%
pivot_longer(cols = starts_with("danceability_percent"):starts_with("speechiness_percent"),
names_to = "attribute",
values_to = "percent") %>%
select(released_year, attribute, percent)
ui <- dashboardPage(
dashboardHeader(title = "Spotify Wrapped"),
## Sidebar content
dashboardSidebar(
sidebarMenu(
menuItem("Home",
tabName = "dashboard",
icon = icon("home")),
menuItem("Background",
icon = icon("list"),
menuSubItem("Introduction", tabName = "introduction"),
menuSubItem("Methods", tabName = "methods")),
menuItem("Top Artists",
tabName = "artist",
icon = icon("user")),
menuItem("Top Songs",
tabName = "songs",
icon = icon("music")),
menuItem("Song Attributes",
tabName = "attribute",
icon = icon("chart-simple")),
menuItem("Attributes Over Time",
tabName = "history",
icon = icon("calendar-days")),
menuItem("Summary",
tabName = "summary",
icon = icon("clipboard-check"))
)
),
## Body content
dashboardBody(
theme = bs_theme(
bootswatch = "darkly",
primary = "#1DB954"
),
tags$style(HTML("
body, .content-wrapper, .main-sidebar, .main-header {
background-color: #000000 !important;
color: #FFFFFF !important;
}
.box {
background-color: #2f2f2f !important;
color: #FFFFFF !important;
}
.sidebar-menu > li > a {
color: #FFFFFF !important;
}
.navbar, .sidebar {
background-color: #000000 !important;
}
.main-header .navbar {
background-color: #1DB954 !important;
}
.main-header .logo {
background-color: #1DB954 !important;
}
.skin-green .sidebar-menu > li.active > a {
background-color: #1DB954 !important;
}
")),
tabItems(
## First tab content
tabItem(tabName = "dashboard",
fluidRow(
tags$div(style = "display: flex; justify-content: center; align-items: center;",
imageOutput("cover", height = "auto", width = "100%")
)
)
),
tabItem(tabName = "introduction",
tags$h1("Introduction"),
tags$h2("About This Project")
),
tabItem(tabName = "methods",
tags$h1("Methods"),
tags$h3("Data Collection"),
tags$h3("Preprocessing"),
tags$ul(
tags$li(" xyz"),
tags$li("abc")
)),
tabItem(tabName = "attribute",
tags$h2("Relationships between Song Attributes"),
fluidPage(
selectInput("x",
"Select X Variable",
choices = c("danceability_percent", "valence_percent", "energy_percent", "acousticness_percent",
"instrumentalness_percent", "liveness_percent", "speechiness_percent" ),
selected = "danceability_percent"),
selectInput("y",
"Select Y Variable",
choices = c("danceability_percent", "valence_percent", "energy_percent", "acousticness_percent",
"instrumentalness_percent", "liveness_percent", "speechiness_percent" ),
selected = "danceability_percent"),
plotOutput("attribute_plot", width = "500px", height = "400px")
)
),
tabItem(tabName= "history",
h2("Song Attributes Over the Years"),
fluidPage(
selectInput("x",
"Select Attribute:",
choices = c("danceability_percent", "valence_percent", "energy_percent", "acousticness_percent",
"instrumentalness_percent", "liveness_percent", "speechiness_percent"),
selected = "danceability_percent"),
plotOutput("lineplot",  width = "500px", height = "400px")
)
),
tabItem(tabName = "artist",
h2("Top 10 Spotify Artists by Category"),
fluidPage(
selectInput("y", "Select Ranking Metric:",
choices = c("Most Streams" = "total_streams",
"Most Songs on Charts" = "total_charts",
"Most Songs in Playlists" = "total_playlists"),
selected="total_streams"),
plotOutput("barplot")
)
),
tabItem(tabName = "songs",
h2("Top 10 Spotify Songs by Category"),
fluidPage(
selectInput("y", "Select Ranking Metric:",
choices = c("Most Streams" = "total_streams",
"Most Songs on Charts" = "total_charts",
"Most Songs in Playlists" = "total_playlists"),
selected="total_streams"),
plotOutput("barplot2")
)
)
)
)
)
server <- function(input, output, session) {
session$onSessionEnded(stopApp)
output$cover <- renderImage({
list(src = "cover.png", contentType = "image/png", alt = "Cover Image",
width = "100%", height = "auto")  # Let height adjust automatically
}, deleteFile = FALSE)
output$attribute_plot <- renderPlot({
ggplot(data=spotify_data,
aes_string(x=input$x, y=input$y))+
geom_point(color = "#1ED760")+
theme_light(base_size = 14)
})
output$lineplot <- renderPlot({
spotify_data_long %>%
filter(attribute==input$x) %>%
group_by(released_year, attribute) %>%
group_by(released_year, attribute) %>%  # This line might cause redundancy; one `group_by` is enough
ggplot(aes(x=released_year, y=percent))+
geom_line(color = "#1ED760")
})
output$barplot <- renderPlot({
top_artists <- artist_app_data %>%
arrange(desc(!!sym(input$y))) %>%  # Sort by selected metric
head(10)
ggplot(data=top_artists,
aes_string(x="`artist_s_name`", y=input$y))+
geom_col(fill = "#1DB954")+
labs(x="Artist", y="Metric")+
theme_classic()
})
output$barplot2 <- renderPlot({
top_songs <- song_app_data %>%
arrange(desc(!!sym(input$y))) %>%  # Sort by selected metric
head(10)
ggplot(data=top_songs,
aes_string(x="`track_name`", y=input$y))+
geom_col(fill = "#1DB954")+
coord_flip()+
labs(x="Song", y="Metric")+
theme_classic()
})
}
shinyApp(ui, server)
View(spotify_data)
# Filtered data frame from the app
artist_app_data <- spotify_data %>%
mutate(streams=as.numeric(streams, na.rm=T)) %>%
group_by(artist_s_name) %>%
summarize(total_streams=sum(streams, na.rm=T),
total_charts=sum(in_spotify_charts, na.rm=T),
total_playlists=sum(in_spotify_playlists, na.rm=T))
View(spotify_data)
ui <- dashboardPage(
dashboardHeader(title = "Spotify Wrapped"),
## Sidebar content
dashboardSidebar(
sidebarMenu(
menuItem("Home",
tabName = "dashboard",
icon = icon("home")),
menuItem("Background",
icon = icon("list"),
menuSubItem("Introduction", tabName = "introduction"),
menuSubItem("Methods", tabName = "methods")),
menuItem("Top Artists",
tabName = "artist",
icon = icon("user")),
menuItem("Top Songs",
tabName = "songs",
icon = icon("music")),
menuItem("Song Attributes",
tabName = "attribute",
icon = icon("chart-simple")),
menuItem("Attributes Over Time",
tabName = "history",
icon = icon("calendar-days")),
menuItem("Summary",
tabName = "summary",
icon = icon("clipboard-check")),
)
),
## Body content
dashboardBody(
theme = bs_theme(
bootswatch = "darkly",
primary = "#1DB954"
),
tags$style(HTML("
body, .content-wrapper, .main-sidebar, .main-header {
background-color: #000000 !important;
color: #FFFFFF !important;
}
.box {
background-color: #2f2f2f !important;
color: #FFFFFF !important;
}
.sidebar-menu > li > a {
color: #FFFFFF !important;
}
.navbar, .sidebar {
background-color: #000000 !important;
}
.main-header .navbar {
background-color: #1DB954 !important;
}
.main-header .logo {
background-color: #1DB954 !important;
}
.skin-green .sidebar-menu > li.active > a {
background-color: #1DB954 !important;
}
")),
tabItems(
## First tab content
tabItem(tabName = "dashboard",
fluidRow(
tags$div(style = "display: flex; justify-content: center; align-items: center;",
imageOutput("cover", height = "auto", width = "100%")
)
)
),
tabItem(tabName = "introduction",
tags$h1("Introduction"),
tags$h2("About This Project")
),
tabItem(tabName = "methods",
tags$h1("Methods"),
tags$h3("Data Collection"),
tags$h3("Preprocessing"),
tags$ul(
tags$li(" xyz"),
tags$li("abc")
)),
tabItem(tabName = "attribute",
tags$h2("Relationships between Song Attributes"),
fluidPage(
selectInput("x",
"Select X Variable",
choices = c("danceability_percent", "valence_percent", "energy_percent", "acousticness_percent",
"instrumentalness_percent", "liveness_percent", "speechiness_percent" ),
selected = "danceability_percent"),
selectInput("y",
"Select Y Variable",
choices = c("danceability_percent", "valence_percent", "energy_percent", "acousticness_percent",
"instrumentalness_percent", "liveness_percent", "speechiness_percent" ),
selected = "danceability_percent"),
plotOutput("attribute_plot", width = "500px", height = "400px")
)
),
tabItem(tabName= "history",
h2("Song Attributes Over the Years"),
fluidPage(
selectInput("x",
"Select Attribute:",
choices = c("danceability_percent", "valence_percent", "energy_percent", "acousticness_percent",
"instrumentalness_percent", "liveness_percent", "speechiness_percent"),
selected = "danceability_percent"),
plotOutput("lineplot",  width = "500px", height = "400px")
)
),
tabItem(tabName = "artist",
h2("Top 10 Spotify Artists by Category"),
fluidPage(
selectInput("y", "Select Ranking Metric:",
choices = c("Most Streams" = "total_streams",
"Most Songs on Charts" = "total_charts",
"Most Songs in Playlists" = "total_playlists"),
selected="total_streams"),
plotOutput("barplot")
)
),
tabItem(tabName = "songs",
h2("Top 10 Spotify Songs by Category"),
fluidPage(
selectInput("y", "Select Ranking Metric:",
choices = c("Most Streams" = "total_streams",
"Most Songs on Charts" = "total_charts",
"Most Songs in Playlists" = "total_playlists"),
selected="total_streams"),
plotOutput("barplot2")
)
)
)
)
)
